CalculateKuromi.java

```java

package com.arvin.demo;

import com.arvin.demo.kuromi.Resource;

import java.io.IOException;
import java.util.ArrayList;
import java.util.Arrays;
import java.util.List;
import java.util.Map;

public class calculateKuromi {
    static List<List<Integer>> result;
    static Resource resource;

    static {
        try {
            resource = new Resource("/Users/wangzhulin/study/kafka/kafka-java-demo/src/main/resources/toptoy.txt");
        } catch (IOException e) {
            e.printStackTrace();
        }
    }

    public static void main(String[] args) throws IOException {
        int[] nums = resource.getNums();
        result = calculate(nums);

        Map<Integer, List<Integer>> impossibleMap = resource.getImpossibleMap();
        List<List<Integer>> finalResult = new ArrayList<>();
        int[][] count = new int[resource.getSize()][1];
        int[] determineResult = resource.getDetermineResult();
        for (List<Integer> integers : result) {
            finalResult.add(integers);
            for (int i = 0; i < integers.size(); i++) {
                Integer target = integers.get(i);
                // 该位置固定奖品
                int price = determineResult[i];
                if (price > 0 && target != price) {
                    finalResult.remove(integers);
                    break;
                }
                // 该位置不可能的奖品
                List<Integer> impossible = impossibleMap.get(i);
                if (impossible != null && impossible.size() > 0) {
                    if (impossible.contains(target)) {
                        finalResult.remove(integers);
                        break;
                    }
                }
            }

        }
        System.out.println("所有结果：" + result.size());
        System.out.println("最终结果：" + finalResult.size());


        // 打印结果
        for (List<Integer> integers : finalResult) {
            for (int i = 0; i < integers.size(); i++) {
                Integer integer = integers.get(i);
                if (integer == resource.getTarget()) {
                    count[i][0] += 1;
                }
                System.out.print(integer + " ");

            }
            System.out.println();
        }
        System.out.println(Arrays.deepToString(count));

    }

    private static List<List<Integer>> calculate(int[] nums) {
        //
        result = new ArrayList<>();

        // 回溯过程收集的元素
        List<Integer> team = new ArrayList<>();
        // 标记
        boolean[] jud = new boolean[nums.length];
        dfs(jud, nums, team, 0);
        return result;
    }

    /**
     * 遍历寻找可能的结果
     */
    private static void dfs(boolean[] jud, int[] nums, List<Integer> team, int index, boolean flag) {
        int len = nums.length;
        if (index == len && flag) {
            result.add(new ArrayList<>(team));
        } else {
            for (int i = 0; i < len; i++) {
                if (jud[i]) {
                    continue;
                }
                if (flag) {
                    flag = checkResult(nums[i], i, resource);
                    continue;
                }
                team.add(nums[i]);

                jud[i] = true;
                dfs(jud, nums, team, index + 1, flag);
                jud[i] = false;
                team.remove(index);
            }
        }

    }

    private static boolean checkResult(int target, int index, Resource resource) {
        boolean checkResult = true;
        int[] determineResult = resource.getDetermineResult();
        int price = determineResult[index];
        if (price > 0 && target != price) {
            checkResult = false;
        }
        return checkResult;
    }


}

```

Resouce.java

```java
package com.arvin.demo.kuromi;

import java.io.BufferedReader;
import java.io.IOException;
import java.nio.file.Files;
import java.nio.file.Path;
import java.nio.file.Paths;
import java.util.ArrayList;
import java.util.HashMap;
import java.util.List;
import java.util.Map;

public class Resource {
    private final String[] prize;
    private final int[] nums;
    private final int target;
    private final int size;
    private final String targetName;
    private final Map<Integer, List<Integer>> impossibleMap = new HashMap<>();
    private final int[] determineResult;

    public Resource(String fileName) throws IOException {
        Path path = Paths.get(fileName);
        BufferedReader bufferedReader = Files.newBufferedReader(path);
        String line;
        List<String> lineList = new ArrayList<>();
        while ((line = bufferedReader.readLine()) != null) {
            lineList.add(line);
        }
        bufferedReader.close();

        // 处理获取到到数据
        // 奖品
        String prizeString = lineList.get(0);
        this.prize = prizeString.split(" ");
        this.nums = new int[prize.length];
        for (int i = 0; i < nums.length; i++) {
            nums[i] = i + 1;
        }

        // 要抽取的目标
        String targetString = lineList.get(2);
        String[] targetArr = targetString.split(" ");
        this.size = Integer.parseInt(targetArr[0]);
        this.target = Integer.parseInt(targetArr[1]);
        this.targetName = prize[target - 1];
        this.determineResult = new int[size];

        for (int i = 3; i < lineList.size(); i++) {
            String lines = lineList.get(i);
            String[] impossibleArr = lines.split(" ");
            int index = Integer.parseInt(impossibleArr[0]) - 1;
            List<Integer> impossibleTarget = new ArrayList<>();
            determineResult[index] = Integer.parseInt(impossibleArr[1]);
            for (int j = 2; j < impossibleArr.length; j++) {
                impossibleTarget.add(Integer.parseInt(impossibleArr[j]));
            }
            impossibleMap.put(index, impossibleTarget);
        }
    }

    public String[] getPrize() {
        return prize;
    }

    public int getTarget() {
        return target;
    }

    public int getSize() {
        return size;
    }

    public String getTargetName() {
        return targetName;
    }

    public Map<Integer, List<Integer>> getImpossibleMap() {
        return impossibleMap;
    }

    public int[] getDetermineResult() {
        return determineResult;
    }

    public int[] getNums() {
        return nums;
    }
}

```

